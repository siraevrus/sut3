# Система складского учета (SUT)

Веб-приложение для управления складскими операциями с поддержкой ролей пользователей, настраиваемых характеристик товаров и автоматическим расчетом по формулам.

## Возможности

- **Управление пользователями**: 4 роли с разными правами доступа
- **Управление компаниями и складами**: полная иерархия организационной структуры
- **Настраиваемые шаблоны товаров**: с формулами автоматического расчета
- **Складские операции**: приемка, отгрузка, остатки, реализация
- **Система запросов**: между сотрудниками с разными ролями
- **REST API**: для будущего мобильного приложения
- **Адаптивный дизайн**: корректная работа на всех устройствах

## Роли пользователей

1. **Администратор** - полный доступ ко всем разделам
2. **Оператор ПК** - товары, остатки, товар в пути
3. **Работник склада** - запросы, остатки, товар в пути, реализация, приемка
4. **Менеджер по продажам** - запросы, остатки, товар в пути

## Технические требования

- **PHP**: 8.1+
- **MySQL**: 5.7+ (InnoDB)
- **Apache/Nginx**: с mod_rewrite
- **Браузер**: современный с поддержкой ES6+

## Установка

### 1. Клонирование репозитория

```bash
git clone https://github.com/siraevrus/sut3.git
cd sut3
```

### 2. Настройка веб-сервера

#### Apache
Убедитесь, что включены модули:
- mod_rewrite
- mod_php

#### Nginx
Добавьте в конфигурацию:
```nginx
location / {
    try_files $uri $uri/ /index.php?$query_string;
}

location ~ \.php$ {
    fastcgi_pass unix:/var/run/php/php8.1-fpm.sock;
    fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
    include fastcgi_params;
}
```

### 3. Настройка базы данных

1. Создайте базу данных MySQL:
```sql
CREATE DATABASE sut_warehouse CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

2. Отредактируйте файл `config/database.php`:
```php
define('DB_HOST', 'localhost');
define('DB_NAME', 'sut_warehouse');
define('DB_USER', 'your_username');
define('DB_PASS', 'your_password');
```

3. Импортируйте схему базы данных:
```bash
mysql -u your_username -p sut_warehouse < sql/schema.sql
```

4. Импортируйте начальные данные:
```bash
mysql -u your_username -p sut_warehouse < sql/initial_data.sql
```

### 4. Настройка прав доступа

```bash
# Права на папку загрузок
chmod -R 755 uploads/
chown -R www-data:www-data uploads/

# Права на папку логов
mkdir logs/
chmod -R 755 logs/
chown -R www-data:www-data logs/
```

### 5. Первый запуск

1. Откройте браузер и перейдите на ваш домен
2. Войдите с данными администратора по умолчанию:
   - **Логин**: admin
   - **Пароль**: admin123
3. **Обязательно смените пароль** после первого входа

## Структура проекта

```
sut3/
├── api/                    # REST API для мобильного приложения
├── assets/                 # Статические ресурсы
│   ├── css/               # CSS стили
│   ├── js/                # JavaScript файлы
│   └── images/            # Изображения
├── config/                # Конфигурационные файлы
├── includes/              # Общие PHP файлы
├── pages/                 # Страницы приложения
│   ├── auth/              # Авторизация
│   ├── companies/         # Управление компаниями
│   ├── employees/         # Управление сотрудниками
│   ├── products/          # Товары
│   ├── requests/          # Запросы
│   ├── inventory/         # Остатки
│   ├── transit/           # Товар в пути
│   ├── sales/             # Реализация
│   ├── receiving/         # Приемка товара
│   └── templates/         # Характеристики товаров
├── sql/                   # SQL скрипты
├── uploads/               # Загруженные файлы
└── logs/                  # Логи системы
```

## Использование

### Создание шаблона товара

1. Перейдите в раздел "Характеристики товара"
2. Нажмите "Создать шаблон"
3. Заполните название и добавьте характеристики
4. Укажите формулу расчета (например: `length * width * height`)
5. Протестируйте формулу

### Добавление товара

1. Перейдите в раздел "Товары"
2. Нажмите "Добавить товар"
3. Выберите шаблон товара
4. Заполните характеристики
5. Объем рассчитается автоматически по формуле

### Работа с запросами

**Для сотрудников (создание запроса):**
1. Перейдите в раздел "Запросы"
2. Нажмите "Отправить запрос"
3. Выберите товар и заполните характеристики
4. Отправьте запрос

**Для администратора (обработка):**
1. В разделе "Запросы" видны все запросы
2. Нажмите на запрос для просмотра деталей
3. Нажмите "Запрос обработан" для изменения статуса

## API

REST API доступен по адресу `/api/` и предназначен для мобильного приложения.

### Аутентификация
```http
POST /api/auth/login
Content-Type: application/json

{
    "login": "username",
    "password": "password"
}
```

### Получение остатков
```http
GET /api/inventory
Authorization: Bearer {token}
```

Полная документация API будет доступна в разделе `/api/docs` после завершения разработки.

## Безопасность

- Все пользовательские данные валидируются и экранируются
- Используются подготовленные SQL запросы
- CSRF защита для всех форм
- Ограничения на типы и размеры загружаемых файлов
- Хеширование паролей с использованием bcrypt

## Поддержка

При возникновении проблем:

1. Проверьте логи в папке `logs/`
2. Убедитесь в корректности настроек в `config/`
3. Проверьте права доступа к папкам
4. Создайте issue в репозитории GitHub

## Лицензия

Этот проект разработан для внутреннего использования.

## Версии

- **v1.0.0** - Первый релиз с базовым функционалом